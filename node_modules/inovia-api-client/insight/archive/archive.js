"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function _objectWithoutProperties(e,t){var r={};for(var i in e)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i]);return r}function listRoot(e,t){return listFolder(e,"/",t)}function listFolder(e,t,r){return httpClient.post(_configService.getConfig("archive","listFolder"),{store:e,path:t},r).then(function(e){return e.data}).then(function(e){return e.map(function(e){var t=e.fileName,r=e.fileSize,i=e.time,n=e.path,o=e.id,a=e.senderHostName,s=e.senderUserName,l=e.type,c=e.mimeType,p=e.customFieldValues,u=n||"/";return{name:t,fileSize:r,timeStamp:i.toString(),path:u,id:o,senderHostName:a,senderUserName:s,customFieldValues:p,type:l,mimeType:c}})})}function create(e,t){return httpClient.post(_configService.getConfig("archive","create"),e,t)}function deleteStore(e,t,r){return httpClient._delete(_configService.getConfig("archive","deleteStore",{storeType:e,storeName:t}),r)}function deleteFile(e,t,r){return httpClient._delete(_configService.getConfig("archive","deleteFile",{fileId:t,storeName:e}),r)}function deleteFolder(e,t,r){return httpClient.post(_configService.getConfig("archive","deleteFolder"),{store:e,path:t},r)}function preview(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3,n=arguments[4];return httpClient.get(_configService.getConfig("archive","preview",{storeName:e,fileId:t,page:r,numChars:i}),Object.assign({headers:{Accept:"text/plain"},responseType:"text"},n)).then(function(e){return e.data}).then(function(e){return"string"==typeof e?e:JSON.stringify(e)})}function generateDownloadLink(e,t){return _configService.getConfig("archive","downloadLink",{storeName:e,fileId:t})}function search(e,t,r){var i={page:1,pageSize:1e3,queryString:t,store:e,dateRange:{dateField:"_time",timeZone:"UTC",to:new Date,from:new Date(0)}};return httpClient.post(_configService.getConfig("rtc","search"),i,r).then(function(e){return e.data}).then(function(e){return e.result.map(function(e){var t=e.fileName,r=e.fileSize,i=e._time,n=e.path,o=e.UUID,a=e.senderHostName,s=e.senderUserName,l=e.mimeType,c=_objectWithoutProperties(e,["fileName","fileSize","_time","path","UUID","senderHostName","senderUserName","mimeType"]),p=n||"/",u="/"===p[0]?p:"/"+p;return{name:t,fileSize:r,timeStamp:i,path:u,type:"FILE",id:o,senderHostName:a,senderUserName:s,customFieldValues:Object.keys(c).map(function(e){return c[e]}),mimeType:l}})})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.listRoot=listRoot,exports.listFolder=listFolder,exports.create=create,exports.deleteStore=deleteStore,exports.deleteFile=deleteFile,exports.deleteFolder=deleteFolder,exports.preview=preview,exports.generateDownloadLink=generateDownloadLink,exports.search=search;var _httpClient=require("../../httpClient"),httpClient=_interopRequireWildcard(_httpClient),_configService=require("../../configService");