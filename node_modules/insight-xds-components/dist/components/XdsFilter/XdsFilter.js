"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),_react=require("react"),_react2=_interopRequireDefault(_react),_reactAddonsPureRenderMixin=require("react-addons-pure-render-mixin"),_reactAddonsPureRenderMixin2=_interopRequireDefault(_reactAddonsPureRenderMixin),_RaisedButton=require("material-ui/RaisedButton"),_RaisedButton2=_interopRequireDefault(_RaisedButton),_XdsFilterLogic=require("./XdsFilterLogic"),_XdsFilterLogic2=_interopRequireDefault(_XdsFilterLogic),_momentTimezone=require("moment-timezone"),_momentTimezone2=_interopRequireDefault(_momentTimezone),_constants=require("../../constants"),XdsFilter=function(e){function t(){var e;_classCallCheck(this,t);for(var r=arguments.length,a=Array(r),i=0;r>i;i++)a[i]=arguments[i];var s=_possibleConstructorReturn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a)));return s.state=Object.assign({},{dirty:!1,filter:Object.assign({},s.props.filter)}),s._applyChanges=s._applyChanges.bind(s),s._updateChildFilter=s._updateChildFilter.bind(s),s._clearFilter=s._clearFilter.bind(s),s.getCurrentFilter=s.getCurrentFilter.bind(s),s.shouldComponentUpdate=_reactAddonsPureRenderMixin2["default"].shouldComponentUpdate.bind(s),s}return _inherits(t,e),_createClass(t,[{key:"componentWillReceiveProps",value:function(e){e.filter!==this.props.filter&&this.setState(Object.assign({},{dirty:!1,filter:Object.assign({},e.filter)}))}},{key:"_updateChildFilter",value:function(e){this.setState({filter:e,dirty:!0}),this.props.showApplyButton||this.props.applyCallback(e)}},{key:"_applyChanges",value:function(){this.props.applyCallback&&this.props.applyCallback(this.state.filter),this.setState({dirty:!1})}},{key:"_clearFilter",value:function(){this.setState({filter:{logic:"AND",filters:[]},dirty:!0})}},{key:"getCurrentFilter",value:function(){return this.state.filter}},{key:"render",value:function(){var e=this.context.muiTheme,t=void 0,r=void 0;return this.props.showClearButton&&(t=_react2["default"].createElement(_RaisedButton2["default"],{label:"Clear Filter",onClick:this._clearFilter})),this.props.showApplyButton&&(r=_react2["default"].createElement(_RaisedButton2["default"],{label:"Apply",primary:!0,disabled:!this.state.dirty,onClick:this._applyChanges,style:{marginLeft:e.spacing.desktopGutterLess}})),_react2["default"].createElement("div",{className:"custom-filter"},_react2["default"].createElement("div",{className:"custom-filter-main-actions"},t,r),_react2["default"].createElement(_XdsFilterLogic2["default"],{isRoot:!0,filter:this.state.filter,mappings:this.props.mappings,updateChildFilter:this._updateChildFilter,timeZone:this.props.timeZone,operators:this.props.operators}))}}]),t}(_react2["default"].Component);XdsFilter.propTypes={filter:_react2["default"].PropTypes.object.isRequired,mappings:_react2["default"].PropTypes.arrayOf(_react2["default"].PropTypes.shape({name:_react2["default"].PropTypes.string.isRequired,type:_react2["default"].PropTypes.string.isRequired})),applyCallback:_react2["default"].PropTypes.func,timeZone:_react2["default"].PropTypes.string.isRequired,showApplyButton:_react2["default"].PropTypes.bool,showClearButton:_react2["default"].PropTypes.bool,operators:_react2["default"].PropTypes.shape({string:_react2["default"].PropTypes.arrayOf(_react2["default"].PropTypes.shape({value:_react2["default"].PropTypes.string.isRequired,text:_react2["default"].PropTypes.string.isRequired})),number:_react2["default"].PropTypes.arrayOf(_react2["default"].PropTypes.shape({value:_react2["default"].PropTypes.string.isRequired,text:_react2["default"].PropTypes.string.isRequired})),date:_react2["default"].PropTypes.arrayOf(_react2["default"].PropTypes.shape({value:_react2["default"].PropTypes.string.isRequired,text:_react2["default"].PropTypes.string.isRequired})),bool:_react2["default"].PropTypes.arrayOf(_react2["default"].PropTypes.shape({value:_react2["default"].PropTypes.string.isRequired,text:_react2["default"].PropTypes.string.isRequired})),dynamicDate:_react2["default"].PropTypes.arrayOf(_react2["default"].PropTypes.shape({value:_react2["default"].PropTypes.string.isRequired,text:_react2["default"].PropTypes.string.isRequired}))}).isRequired},XdsFilter.defaultProps={filter:{field:"",value:"",operator:"EQ"},timeZone:_momentTimezone2["default"].tz.guess(),showApplyButton:!0,showClearButton:!0,operators:{string:_constants.FILTER_DEFAULT_STRING_OPERATORS,number:_constants.FILTER_DEFAULT_NUMBER_OPERATORS,date:_constants.FILTER_DEFAULT_DATE_OPERATORS,bool:_constants.FILTER_DEFAULT_BOOLEAN_OPERATORS,dynamicDate:_constants.FILTER_DEFAULT_DYNAMIC_DATE_OPERATORS}},XdsFilter.contextTypes={muiTheme:_react2["default"].PropTypes.object.isRequired},exports["default"]=XdsFilter;