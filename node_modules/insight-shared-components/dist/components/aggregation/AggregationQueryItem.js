"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.AggregationQueryItem=void 0;var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),_react=require("react"),_react2=_interopRequireDefault(_react),_reactDom=require("react-dom"),_reactDom2=_interopRequireDefault(_reactDom),_classnames=require("classnames"),_classnames2=_interopRequireDefault(_classnames),_Chip=require("material-ui/Chip"),_Chip2=_interopRequireDefault(_Chip),_Avatar=require("material-ui/Avatar"),_Avatar2=_interopRequireDefault(_Avatar),_Popover=require("material-ui/Popover"),_Popover2=_interopRequireDefault(_Popover),_edit=require("material-ui/svg-icons/image/edit"),_edit2=_interopRequireDefault(_edit),_ValidatableDropDownList=require("../ValidatableDropDownList"),_ValidatableDropDownList2=_interopRequireDefault(_ValidatableDropDownList),_ValidatableTextField=require("../ValidatableTextField"),_ValidatableTextField2=_interopRequireDefault(_ValidatableTextField),aggregationUnits=["AVG","CNT","UNIQUE","DETAILED_METRICS","MAX","MIN","SUM","METRICS","STD","SSQ","VAR","PERCENTILE","RANK_PERCENTILE","CDY"],AggregationQueryItem=exports.AggregationQueryItem=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a._handleTouchTap=a._handleTouchTap.bind(a),a._onRemove=a._onRemove.bind(a),a._handleDropDownChange=a._handleDropDownChange.bind(a),a._handleTextFieldChange=a._handleTextFieldChange.bind(a),a.state={isConfigOpen:!1},a}return _inherits(t,e),_createClass(t,[{key:"_onRemove",value:function(){var e=this.props,t=e.onRemove,a=e.query;t(a)}},{key:"_handleTouchTap",value:function(){this.setState({isConfigOpen:!this.state.isConfigOpen})}},{key:"_handleDropDownChange",value:function(e){var t=this.props,a=t.onAggChange,r=t.query;a(Object.assign({},r,{aggregation:e}))}},{key:"_handleTextFieldChange",value:function(e){var t=e.target.value,a=this.props,r=a.query,n=a.onNameChange,i=r.name;n(Object.assign({},r,{name:t}),i)}},{key:"render",value:function(){var e=this,t=this.props,a=t.query,r=t.isDragging;return _react2["default"].createElement("div",{className:_classnames2["default"]("dnd-item",{isDragging:r})},_react2["default"].createElement(_Chip2["default"],{onRequestDelete:this._onRemove},_react2["default"].createElement(_Avatar2["default"],{icon:_react2["default"].createElement(_edit2["default"],null),onTouchTap:this._handleTouchTap,style:{cursor:"pointer"},ref:function(t){return e.itemEditAnchor=_reactDom2["default"].findDOMNode(t)}}),_react2["default"].createElement("div",{className:"group-by-field flex-item"},a.name+": "+a.aggregation+" of "+a.field),_react2["default"].createElement(_Popover2["default"],{open:this.state.isConfigOpen,anchorEl:this.itemEditAnchor,onRequestClose:this._handleTouchTap.bind(this)},_react2["default"].createElement(_ValidatableTextField2["default"],{isRequired:!1,hintText:"Query Name",floatingLabelText:"Query Name",value:a.name,onChange:this._handleTextFieldChange}),_react2["default"].createElement(_ValidatableDropDownList2["default"],{items:aggregationUnits,floatingLabelText:"Aggregation",onChange:this._handleDropDownChange,value:a.aggregation?a.aggregation:""}))))}}]),t}(_react2["default"].Component);AggregationQueryItem.propTypes={query:_react2["default"].PropTypes.shape({name:_react2["default"].PropTypes.string.isRequired,field:_react2["default"].PropTypes.string.isRequired,aggregation:_react2["default"].PropTypes.string}).isRequired,onAggChange:_react2["default"].PropTypes.func.isRequired,onNameChange:_react2["default"].PropTypes.func.isRequired},exports["default"]=AggregationQueryItem;