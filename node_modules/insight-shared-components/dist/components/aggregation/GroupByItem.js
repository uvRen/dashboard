"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.GroupByItem=void 0;var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),_react=require("react"),_react2=_interopRequireDefault(_react),_reactDom=require("react-dom"),_reactDom2=_interopRequireDefault(_reactDom),_classnames=require("classnames"),_classnames2=_interopRequireDefault(_classnames),_IntervalSelector=require("../IntervalSelector"),_IntervalSelector2=_interopRequireDefault(_IntervalSelector),_RangeSelector=require("../RangeSelector"),_RangeSelector2=_interopRequireDefault(_RangeSelector),_edit=require("material-ui/svg-icons/image/edit"),_edit2=_interopRequireDefault(_edit),_Avatar=require("material-ui/Avatar"),_Avatar2=_interopRequireDefault(_Avatar),_Popover=require("material-ui/Popover"),_Popover2=_interopRequireDefault(_Popover),_valueType=require("../../utils/valueType"),_Chip=require("material-ui/Chip"),_Chip2=_interopRequireDefault(_Chip),GroupByItem=exports.GroupByItem=function(e){function t(e){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._onRemove=r._onRemove.bind(r),r._updateItem=r._updateItem.bind(r),r.state={editOpen:!1},r}return _inherits(t,e),_createClass(t,[{key:"_onRemove",value:function(){var e=this.props,t=e.onRemove,r=e.item;t(r)}},{key:"_handleTouchTap",value:function(){this.setState({editOpen:!this.state.editOpen})}},{key:"_updateItem",value:function(e){var t=this.props.onUpdate;t(e)}},{key:"render",value:function(){var e=this,t=this.props,r=t.item,a=t.isDragging,o=t.mapping,n=_valueType.isEditableItem(o.type);return _react2["default"].createElement("div",{className:_classnames2["default"]("dnd-item",{isDragging:a})},_react2["default"].createElement(_Chip2["default"],{onRequestDelete:this._onRemove},n&&_react2["default"].createElement(_Avatar2["default"],{icon:_react2["default"].createElement(_edit2["default"],null),onTouchTap:this._handleTouchTap.bind(this),style:{cursor:"pointer"},ref:function(t){return e.itemEditAnchor=_reactDom2["default"].findDOMNode(t)}}),n&&_react2["default"].createElement(_Popover2["default"],{open:this.state.editOpen,anchorEl:this.itemEditAnchor,onRequestClose:this._handleTouchTap.bind(this)},"date"===o.type&&_react2["default"].createElement(_IntervalSelector2["default"],{item:r,onChange:this._updateItem}),("long"===o.type||"integer"===o.type||"double"===o.type||"float"===o.type)&&_react2["default"].createElement(_RangeSelector2["default"],{item:r,onChange:this._updateItem})),r.field))}}]),t}(_react2["default"].Component);GroupByItem.propTypes={item:_react2["default"].PropTypes.shape({field:_react2["default"].PropTypes.string.isRequired,interval:_react2["default"].PropTypes.string,ranges:_react2["default"].PropTypes.arrayOf(_react2["default"].PropTypes.shape({from:_react2["default"].PropTypes.string,to:_react2["default"].PropTypes.string}))}).isRequired,mapping:_react2["default"].PropTypes.shape({name:_react2["default"].PropTypes.string,type:_react2["default"].PropTypes.string}).isRequired,onRemove:_react2["default"].PropTypes.func.isRequired,onUpdate:_react2["default"].PropTypes.func.isRequired},exports["default"]=GroupByItem;